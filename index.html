<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
  <title>Mockup Tienda Zapatos</title>
  <style>
    :root{
      --iphone-w:393px;
      --iphone-h:852px;
      --primary:#ff4dd4;
      --text:#111;
      --muted:#888;
      --bg:#f4f4f6;
    }
    *{box-sizing:border-box; font-family:-apple-system,Arial}
    body{
      margin:0;display:flex;justify-content:center;height:100vh;background:var(--bg);
    }
    .iphone {
  width: var(--iphone-w);
  height: var(--iphone-h);
  background: white;
  border-radius: 40px;
  overflow: hidden;  /* ya estÃ¡, perfecto */
  position: relative;
  box-shadow: 0 0 40px rgba(0,0,0,0.2);
  display: flex;     /* nuevo */
  flex-direction: column; /* organiza pantallas dentro */
}
    /* PANTALLAS */
    .screen {
  display: none;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  overflow-y: auto; /* scroll solo dentro del iphone */
  padding: 20px;
  box-sizing: border-box;
}

    .active{display:block;}

    /* LOGIN */
    .logo{width:160px;margin:40px auto 10px auto;display:block;}
    .input{width:100%;padding:14px;border-radius:10px;border:1px solid #ddd;margin-top:10px;font-size:16px;}
    .btn{width:100%;padding:14px;border-radius:12px;border:none;font-size:17px;cursor:pointer;margin-top:12px;}
    .btn-primary{background:#f700ff;color:white;}
    .btn-google{border:1px solid #ddd;background:white;}

    /* HOME */
    .top-bar{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;}
    .cat-btns{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:15px;}
    .cat{padding:8px 10px;border-radius:20px;border:1px solid #ccc;text-align:center;cursor:pointer;}
    .cat.active{background:black;color:white;border-color:black;}
    .card{background:#fafafa;border-radius:16px;padding:10px;}
    .shoe-img{width:100%;border-radius:12px;}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:10px;}
    .price{font-weight:bold;}
    .color-dot{width:16px;height:16px;border-radius:50%;display:inline-block;margin-right:5px;}
    .add-btn{background:black;color:white;border-radius:8px;padding:8px 0;margin-top:8px;text-align:center;cursor:pointer;}

    /* MODAL */
    .modal{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.4);display:none;align-items:center;justify-content:center;}
    .modal-box{background:white;width:80%;padding:20px;border-radius:20px;}
    .option{padding:10px;border:1px solid #ccc;border-radius:10px;margin-bottom:10px;cursor:pointer;text-align:center;}

    /* CARRITO */
    .cart-item{display:flex;justify-content:space-between;margin-bottom:10px;border-bottom:1px solid #eee;padding-bottom:10px;}
    .pay-btn{background:var(--primary);color:white;border-radius:12px;padding:12px;text-align:center;margin-top:20px;cursor:pointer;}

    /* MÃ‰TODOS DE PAGO */
    .pay-method{border:1px solid #ccc;padding:12px;border-radius:12px;margin-bottom:10px;cursor:pointer;}
    .card-form{display:none;margin-top:10px;}
    .bank-info{display:none;margin-top:10px;font-size:14px;}
  .back{background:none;border:none;font-size:22px;cursor:pointer;padding:4px;margin-bottom:10px;display:block;}
    /* PERSONALIZACIÃ“N */
    .personalizacion-container {
    padding: 15px;
    border-radius: 8px;
    background: #f5f5f5;
    margin-top: 20px;
}

.personalizacion-container label {
    display: block;
    margin-top: 10px;
    font-weight: 600;
}

.personalizacion-container input,
.personalizacion-container select {
    width: 100%;
    padding: 8px;
    margin-top: 4px;
    border-radius: 5px;
    border: 1px solid #ccc;
}
.btn-agregar-carrito {
    margin-top: 20px;
    width: 100%;
    padding: 12px;
    background: #f700ff;
    color: white;
    border: none;
    border-radius: 6px;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    transition: 0.2s ease;
}

.btn-agregar-carrito:hover {
    background: #333;
}

/* ---------- FIX: asegurar que una .screen con .active sea visible --------- */
.screen.active {
  display: block !important;   /* fuerza mostrar la pantalla si tiene .active */
}

/* Estilos especÃ­ficos para la pantalla de personalizaciÃ³n */
#personalizarScreen {
  /* heredamos la posiciÃ³n y tamaÃ±o de las otras pantallas */
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  overflow-y: auto;
  padding: 20px;
  background: white;           /* asegura que no quede en blanco 'transparente' */
  box-sizing: border-box;
}

/* Contenedor interno */
.perso-container {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin: 20px 10px 30px 10px;
}

/* Etiquetas e inputs */
.perso-container label {
  display: block;
  font-weight: 700;
  margin-top: 6px;
  font-size: 14px;
  color: #222;
}

.perso-container select,
.perso-container input[type="text"],
.perso-container input[type="color"] {
  width: 100%;
  padding: 10px;
  border-radius: 10px;
  border: 1px solid #ddd;
  font-size: 15px;
  background: #fff;
  box-shadow: none;
  appearance: none;
}

/* TÃ­tulo */
.titulo {
  text-align: center;
  margin-top: 36px;
  font-size: 20px;
  font-weight: 700;
  color: var(--text, #111);
}

/* BotÃ³n Agregar al carrito */
.btn-agregar-carrito {
  margin-top: 14px;
  padding: 12px;
  background: #111;
  border: none;
  border-radius: 10px;
  color: #fff;
  font-size: 16px;
  cursor: pointer;
}

.btn-agregar-carrito:hover {
  opacity: 0.95;
  transform: translateY(-1px);
}

/* BotÃ³n pequeÃ±o de volver (flecha) */
.back-btn {
  position: absolute;
  top: 12px;
  left: 12px;
  background: none;
  border: none;
  font-size: 26px;
  cursor: pointer;
  color: #333;
  padding: 6px;
}

/* Asegurar contraste si la pantalla usa fondo blanco */
#personalizarScreen .perso-container {
  color: #222;
}

/* Ajustes responsivos: dentro del marco de iPhone */
@media (max-width: 420px) {
  .perso-container { margin: 18px 12px 28px 12px; }
  .titulo { margin-top: 28px; font-size: 18px; }
  .back-btn { top: 10px; left: 8px; font-size: 24px; }
}


  </style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r152/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.152.0/examples/js/loaders/GLTFLoader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.152.0/examples/js/controls/OrbitControls.js"></script>
</head>
<body>
<div class="iphone">

  <!-- LOGIN -->
  <div id="login" class="screen active">
    <img src="images/logo.png" class="logo" />
    <input id="user" class="input" placeholder="Usuario" />
    <input id="pass" type="password" class="input" placeholder="ContraseÃ±a" />
    <button class="btn btn-primary" onclick="goHome()">Iniciar sesiÃ³n</button>
    <button class="btn btn-google" onclick="goHome()">
      <span class="google-content">
        <img src="images/google.png" alt="Google" class="google-logo" />
        <span></span>
        </span>
    </button>
  </div>

  <!-- HOME -->
  <div id="home" class="screen">
    <button class="back" onclick="switchScreen('login')">â—„</button>
    <div class="top-bar">
      <div>ðŸ‘Ÿ Tienda</div>
      <div onclick="openCart()">ðŸ›’ <span id="cartCount">0</span></div>
    </div>

    <div style="font-weight:bold;margin-bottom:8px;">CatÃ¡logo de Zapatos</div>

    <div class="cat-btns">
      <div class="cat active" onclick="filterCat('todos')">Todos</div>
      <div class="cat" onclick="filterCat('deportivos')">Deportivos</div>
      <div class="cat" onclick="filterCat('casuales')">Casuales</div>
      <div class="cat" onclick="filterCat('formales')">Formales</div>
    </div>

    <div class="grid" id="shoeGrid"></div>

    <button class="btn btn-primary" style="margin-top:15px;" onclick="switchScreen('personalizarScreen')">Personaliza tu calzado</button>
  </div>

  <!-- MODAL TALLA / COLOR -->
  <div id="modal" class="modal">
    <div class="modal-box" id="modalContent"></div>
  </div>

  <!-- CARRITO -->
  <div id="cart" class="screen">
    <button class="back" onclick="switchScreen('home')">â—„</button>
    <h2>Carrito</h2>
    <div id="cartItems"></div>

    <div><b>Subtotal: </b>$<span id="subtotal">0</span></div>
    <div><b>EnvÃ­o: </b>$7000</div>
    <div><b>Total: </b>$<span id="total">7000</span></div>

    <div class="pay-btn" onclick="goPay()">Pagar</div>
  </div>

  <!-- PAGO -->
  <div id="pay" class="screen">
    <button class="back" onclick="switchScreen('cart')">â—„</button>
    <h2>MÃ©todos de Pago</h2>

    <div class="pay-method" onclick="selectPay('card')">Tarjeta</div>
    <div class="pay-method" onclick="selectPay('bank')">Transferencia bancaria</div>

    <div class="card-form" id="cardForm">
      <input class="input" placeholder="NÃºmero de tarjeta" />
      <input class="input" placeholder="Fecha vencimiento" />
      <input class="input" placeholder="CSV" />
    </div>

    <div class="bank-info" id="bankInfo">
      Banco: Banco Republica<br>
      Cuenta: 1234-5678-9012<br>
      A nombre de: Angelica Store
    </div>
      <div class="pay-btn" onclick="finishPay()">Pagar ahora</div>

  </div>
<!-- PAGO EXITOSO -->
    <div id="success" class="screen">
    <button class="back" onclick="switchScreen('pay')">â—„</button>

    <div style="text-align:center;margin-top:120px;">
        <div style="font-size:80px;color:green;">âœ”</div>
        <h2 style="color:green;">Realizado Con Exito</h2>
    </div>
    </div>

    <!-- ========== PERSONALIZACIÃ“N DE CALZADO ========== -->
<div id="personalizarScreen" class="screen hidden">

    <!-- BotÃ³n volver (flecha) -->
    <button class="back-btn" onclick="switchScreen('home')">â—„</button>

    <h2 class="titulo">Personaliza tu Calzado</h2>

    <div class="perso-container">

        <label>Talla</label>
        <select id="persTalla">
            <option value="">Seleccione</option>
            <option>36</option>
            <option>37</option>
            <option>38</option>
            <option>39</option>
            <option>40</option>
            <option>41</option>
            <option>42</option>
        </select>

        <label>Material</label>
        <select id="persMaterial">
            <option value="">Seleccione</option>
            <option>Cuero</option>
            <option>SintÃ©tico</option>
            <option>Malla deportiva</option>
            <option>Tela</option>
        </select>

        <label>Color de la suela</label>
        <input type="color" id="persSuela">

        <label>Color del zapato</label>
        <input type="color" id="persZapato">

        <label>Color de los cordones</label>
        <input type="color" id="persCordones">

        <label>Texto personalizado (opcional)</label>
        <input type="text" id="persTexto" maxlength="4" placeholder="Ej: 10, AB">

        <button id="btnAgregarCarrito" class="btn-agregar-carrito">
            Agregar al carrito
        </button>

    </div>
</div>

  


</div>
<script>
let shoes=[
  {id:1,cat:'deportivos',name:'Deportivo',price:89000,img:'images/deportiva.jpg',colors:['Naranja','Rojo','Blanco','Negro','Gris','Verde','Morado']},
  {id:2,cat:'casuales',name:'Urbano',price:95000,img:'images/urbano.jpg',colors:['Negro','Gris','Blanco','Azul']},
  {id:3,cat:'deportivos',name:'Runner Pro',price:120000,img:'images/runner.webp',colors:['Naranja','Rosado','Verde']},
  {id:4,cat:'formales',name:'Oxford Elite',price:135000,img:'images/oxxfor.webp',colors:['Marron','Negro']},
  {id:5,cat:'formales',name:'Gala',price:200000,img:'images/estir.webp',colors:['Marron']},
  {id:6,cat:'deportivos',name:'Winflo',price:118000,img:'images/winflo.webp',colors:['Naranja','Rosado','Verde']},

];

let cart=[];

function goHome(){switchScreen('home');renderShoes(shoes);} 
function openCart(){switchScreen('cart');renderCart();}
function goPay(){switchScreen('pay');}

function switchScreen(id){
  // Oculta todas las pantallas
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  const el = document.getElementById(id);
  if(!el){
    console.warn('switchScreen: elemento no encontrado ->', id);
    return;
  }
  el.classList.add('active');

  // Si abrimos la pantalla custom, inicializar 3D si no estÃ¡ inicializado
  if(id === 'custom' && typeof initShoe3D === 'function' && !window.__shoe3D_inited){
    window.__shoe3D_inited = true;
    initShoe3D();
  }
}

// --- AGREGAR ZAPATO PERSONALIZADO AL CARRITO ---
document.getElementById("btnAgregarCarrito").onclick = function () {
    const talla = document.getElementById("persTalla").value;
    const material = document.getElementById("persMaterial").value;
    const suela = document.getElementById("persSuela").value;
    const zapato = document.getElementById("persZapato").value;
    const cordones = document.getElementById("persCordones").value;
    const texto = document.getElementById("persTexto").value;

    // VALIDACIONES
    if (!talla || !material) {
        alert("Por favor selecciona talla y material.");
        return;
    }

    // CREAR OBJETO DEL PERSONALIZADO
    const personalizado = {
        id: Date.now(), // ID Ãºnico
        name: "Calzado Personalizado",
        price: 160000,  // puedes cambiarlo
        size: talla,
        material: material,
        suela: suela,
        colorZapato: zapato,
        cordones: cordones,
        texto: texto,
        img: "images/personalizado.jpg" 
    };

    // AGREGAR AL CARRITO
    cart.push(personalizado);

    // ACTUALIZAR CONTADOR
    document.getElementById("cartCount").textContent = cart.length;

    // VOLVER AL HOME
    switchScreen("home");
};


function renderShoes(list){
  const g=document.getElementById('shoeGrid');
  g.innerHTML='';
  list.forEach(s=>{
    g.innerHTML+=`
      <div class='card'>
        <img src='${s.img}' class='shoe-img'>
        <div><b>${s.name}</b></div>
        <div class='price'>$ ${s.price.toLocaleString()}</div>
        <div class='add-btn' onclick='addFlow(${s.id})'>Agregar</div>
      </div>`;
  });
}

function filterCat(cat){
  document.querySelectorAll('.cat').forEach(c=>c.classList.remove('active'));
  event.target.classList.add('active');
  renderShoes(cat==='todos'?shoes:shoes.filter(s=>s.cat===cat));
}

let currentShoe=null;
function addFlow(id){currentShoe=shoes.find(s=>s.id===id);openModalSize();}

function openModalSize(){
  modal.style.display='flex';
  modalContent.innerHTML='<h3>Selecciona talla</h3>'+
    [37,38,39,40,41,42].map(t=>`<div class='option' onclick='chooseSize(${t})'>${t}</div>`).join('');
}
let selectedSize=null;
let selectedColor=null;

function chooseSize(t){selectedSize=t;openModalColor();}

function openModalColor(){
  modalContent.innerHTML='<h3>Color</h3>'+
    currentShoe.colors.map(c=>`<div class='option' onclick='finishAdd("${c}")'>${c}</div>`).join('');
}

function finishAdd(c){
  selectedColor=c;
  cart.push({...currentShoe,size:selectedSize,color:selectedColor});
  cartCount.textContent=cart.length;
  modal.style.display='none';
}

// CARRITO
function renderCart() {
  let html = '';
  let subtotal = 0;

  cart.forEach(item => {
    subtotal += item.price;

    html += `
      <div class='cart-item'>
        <div style="display:flex; gap:10px;">
          <img src="${item.img}" style="width:60px; height:60px; object-fit:cover; border-radius:8px;">
          <div>
            <b>${item.name || item.nombre}</b><br>
            ${item.size ? `Talla ${item.size}` : ''} 
            ${item.color ? ` - ${item.color}` : ''}
          </div>
        </div>

        <div>$${item.price}</div>
      </div>
    `;
  });

  document.getElementById('cartItems').innerHTML = html;
  document.getElementById('subtotal').textContent = subtotal;
  document.getElementById('total').textContent = subtotal + 7000;
}


// MÃ‰TODO DE PAGO
function selectPay(type){
  cardForm.style.display = type==='card'?'block':'none';
  bankInfo.style.display = type==='bank'?'block':'none';
}


// ----------------------  Personalizador 3D (Three.js) ----------------------
let scene3, camera3, renderer3, controls3, shoeModel3;
function initShoe3D(){
  const container = document.getElementById('shoe-canvas-container');
  if(!container) return;

  scene3 = new THREE.Scene();
  scene3.background = new THREE.Color(0xf4f4f6);

  camera3 = new THREE.PerspectiveCamera(45, container.clientWidth / container.clientHeight, 0.1, 100);
  camera3.position.set(2,2,4);

  renderer3 = new THREE.WebGLRenderer({ antialias:true, alpha:true });
  renderer3.setSize(container.clientWidth, container.clientHeight);
  container.appendChild(renderer3.domElement);

  const dir = new THREE.DirectionalLight(0xffffff, 1);
  dir.position.set(5,5,5);
  scene3.add(dir);
  scene3.add(new THREE.AmbientLight(0xffffff, 0.6));

  controls3 = new THREE.OrbitControls(camera3, renderer3.domElement);
  controls3.enableDamping = true;
  controls3.dampingFactor = 0.05;

  const loader = new THREE.GLTFLoader();
  loader.load('images/shoe.glb', gltf=>{
    shoeModel3 = gltf.scene;
    shoeModel3.scale.set(2,2,2);
    shoeModel3.position.set(0,-0.6,0);
    scene3.add(shoeModel3);
  }, undefined, err=>{
    console.error('Error cargando modelo 3D:', err);
  });

  window.addEventListener('resize', ()=>{
    if(!container) return;
    camera3.aspect = container.clientWidth / container.clientHeight;
    camera3.updateProjectionMatrix();
    renderer3.setSize(container.clientWidth, container.clientHeight);
  });

  animate3();
}

function animate3(){
  requestAnimationFrame(animate3);
  if(controls3) controls3.update();
  if(renderer3 && camera3) renderer3.render(scene3, camera3);
}

function updatePartColor3(partName, color){
  if(!shoeModel3) return;
  shoeModel3.traverse(child=>{
    if(child.isMesh && child.name === partName){
      if(child.material) child.material.color.set(color);
    }
  });
}

function finishPay(){
  switchScreen('success');
}



function addCustomizedToCart() {

    const talla = document.getElementById("persTalla").value;
    const material = document.getElementById("persMaterial").value;
    const colorSuela = document.getElementById("persSuela").value;
    const colorZapato = document.getElementById("persZapato").value;
    const colorCordones = document.getElementById("persCordones").value;
    const texto = document.getElementById("persTexto").value;

    if (!talla || !material || !colorSuela || !colorZapato || !colorCordones) {
        alert("Por favor completa todas las opciones antes de agregar al carrito.");
        return;
    }

    const personalizado = {
        id: Date.now(),
        name: "Zapatilla Personalizada",
        price: 160000,
        img: "images/personalizado.jpg",
        size: talla,
        material: material,
        suela: colorSuela,
        zapato: colorZapato,
        cordones: colorCordones,
        texto: texto
    };

    cart.push(personalizado);
    document.getElementById("cartCount").textContent = cart.length;

    switchScreen("home");
}


</script>
</body>
</html>
